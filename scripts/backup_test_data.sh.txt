#!/bin/bash
# Backs up a source directory to a timestamped destination.

SOURCE_DIR="/home/tester/critical_test_data/"
BACKUP_PARENT_DIR="/mnt/backups/test_data/"
TIMESTAMP=$(date +%Y-%m-%d_%H-%M-%S)
BACKUP_DIR="${BACKUP_PARENT_DIR}backup_${TIMESTAMP}"

# Ensure the parent backup directory exists
mkdir -p $BACKUP_PARENT_DIR

echo "Starting backup of $SOURCE_DIR..."
# rsync is robust for creating backups
rsync -avh "$SOURCE_DIR" "$BACKUP_DIR"

if [ $? -eq 0 ]; then
  echo "Backup completed successfully at $BACKUP_DIR"
else
  echo "Error: Backup failed."
  exit 1
fi
